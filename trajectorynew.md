Trajectory Drawing Gameplay Overhaul Plan
Step 1: Remove Beacon-Based Guidance

The first major change is eliminating the in-game beacon mechanic entirely. Originally, players would influence the flock by placing wind or attraction beacons during the flight or in a planning phase
GitHub
GitHub
. All beacon UI (e.g. beacon selection panel and placement controls) will be removed from the client. This means deleting or disabling code related to BeaconPanel and the pointerdown event that creates beacons (in GameScene.ts). The server-side beacon logic and BeaconManager can also be retired, as no wind-lure or cohesion boosters will be placed by the player anymore. Additionally, any genetic trait tied to beacons (e.g. beacon_sensitivity) should be dropped or repurposed, since birds will no longer be responding to player signals. By removing beacons, we shift the gameplay from reactive guiding to pure planning – the player’s only direct influence is drawing the path before the level starts.

Step 2: Introduce a Pre-Level Path Drawing Phase

We will add a new planning phase at the start of each level where the player draws a trajectory for the flock to follow. Instead of clicking to place beacons, the user can use the mouse (or touch) to draw a continuous path on the map from the start point to the destination. The game will likely pause at level start and prompt the player to “Draw your migration route.” During this phase, the game scene will capture pointer input to record a path:

Drawing Mechanics: The player can click and drag to draw a free-form line, or click multiple waypoints that auto-connect. We’ll render the path as a visible line on the map (using a Phaser Graphics object) so the player can see the planned route.

Start/End Constraints: The drawn path should begin near the flock’s start position and end at the level’s destination point. We can snap the first point to the flock’s spawn and require the last point to be at (or very close to) the goal. This ensures the path is complete from start to finish.

Editing: Provide a way to clear or redraw if the player is not satisfied (e.g. right-click to undo last point or a “Reset Path” button). The planning phase continues until the player confirms the path (perhaps a “Start Migration” button).

Budget/Length Feedback: We might show the path length or an estimated energy cost as the player draws, helping them judge if it’s too long. There is no strict “budget” on path length, but a very long route will consume more energy (increasing fatigue risk). A UI indicator (like a changing color or a length meter) can convey this.

Once the player finalizes the trajectory, that path is fixed and the level begins with the birds launching from the start along the drawn route.

Step 3: Support Complex Trajectories

The drawn path can be arbitrarily complex, allowing strategic detours. Unlike a simple straight-line, players can sketch curves, zig-zags, or multi-leg routes to avoid hazards and reach resources. The system will record the path as a series of waypoints or continuous curve points in world coordinates. Internally, we’ll store it as a polyline – an array of (x, y) positions that the flock should pass through in order. We must ensure the path data is synced to the simulation (e.g. sent to the server if the sim runs there) before the birds start moving.

This complexity means the game must handle following any shape of route. Birds might need to turn multiple times along the path, so our path-following algorithm (discussed in the next step) should smoothly guide them through each bend. There is effectively no limit to how winding the path can be, but the key trade-off is that longer distances cost more energy
GitHub
. Taking a longer, safer route around a storm or mountain will drain endurance, potentially causing some birds to exhaust before reaching the end. Conversely, a short direct path might go through dangerous areas. This encourages players to draw efficient but safe trajectories. The level design can include multiple possible routes (e.g. a longer one that passes a food source vs. a straight one through a risk zone), and the drawn path system lets the player choose their strategy visually.

To implement this, we’ll likely remove any old notion of pre-set waypoints and instead rely solely on the player’s drawn waypoints. The client should also visually indicate important map features during drawing – for example, show where food sources or hazards are, so the player can route around or through them wisely. Once a complex path is drawn, it remains displayed during the flight as an overlay (perhaps a faint line on the ground or a guiding arrow) to provide feedback on whether the flock is deviating from the intended course.

Step 4: Lock Path and Remove Mid-Flight Control

After the planning phase, when the level actually commences, the player can no longer alter the route or give new commands. No real-time interventions are allowed in this new design. This is a significant shift in gameplay: the player’s role is now entirely preparation and then observation. Once the birds are in the air, you must watch them attempt to follow the drawn path without the ability to drop beacons or redirect them on the fly. This adheres to the “influence-not-control” philosophy while raising the stakes on planning
GitHub
.

All in-flight UI elements related to beacon placement or other signals will be removed or disabled. The only interactions during the flight might be passive ones like adjusting the camera or clicking a bird for info. Essentially, the game becomes “draw then hands-off”. If unforeseen events occur (e.g. a sudden predator spawn), the flock’s fate depends on the initial plan and their autonomous behaviors – the player cannot save them with a quick beacon anymore. This lack of mid-flight control means we must balance the game knowing the player can’t react in real time. Hazard appearances should be telegraphed (or deterministic per level) so that a well-drawn path accounts for them. Also, to keep players engaged, we might allow a speed toggle or pause during flight so they can observe or fast-forward, since their input isn’t needed until the next planning phase.

In code, this step means simplifying the input system: once the game is unpaused to start the level, ignore clicks for beacon placement. The path drawn is the final instruction until the next level. We should thoroughly test that nothing in the simulation still expects beacon inputs (e.g. remove any default AI behavior that assumed a beacon might appear, and ensure the simulation doesn’t stall waiting for player input beyond the path).

Step 5: Implement Flock Path-Following Behavior

With a path in place, we need to modify the bird AI so that the flock will follow the drawn trajectory as closely as they can. This is a core technical challenge of the overhaul. In the current simulation, birds likely move based on boids flocking rules (cohesion, separation, alignment) and simple goal-seeking or beacon influences. We will introduce a new steering component: path following.

How it works: At any given time, each bird (or the flock as a whole) will have a target point on the drawn path that it’s trying to reach. A straightforward approach is to break the path into sequential waypoints: the flock aims for the first waypoint; once a majority of birds reach it (or come within a certain radius), the target switches to the next waypoint, and so on until the destination. This provides a stepwise guide through the route. We’ll integrate this with the boid mechanics:

Each bird’s desired direction will be influenced by the vector toward the current path target. This is analogous to how a beacon’s wind might have pulled them before, but now it’s a pull toward the next path point.

We will weight this path-following force alongside the standard flocking forces. For example, if a bird is far off the drawn line, the path force will steer it back toward the path. If it’s roughly on track, the force is smaller, allowing natural flocking behavior to continue. The path thus acts like an invisible guide that the birds prefer to stick to.

A more continuous technique is to have each bird find the nearest point on the path ahead of it and steer toward a point slightly further along from that (a lookahead point). This helps them follow curves smoothly without overshooting. We can implement this by computing the projection of the bird’s position onto the path polyline and then taking a point a fixed distance ahead on the path for it to seek.

It’s important that path following does not make the birds fly in lockstep like on rails – they should still maintain separation (not all cram on the exact line) and cohesion. We might allow some lateral spacing around the drawn line so the formation has area to maneuver. If the path has a sharp turn, not all birds will hit the exact same spot; some might take a slightly wider turn, but as long as they then converge back toward the next segment, that’s fine. The algorithm might consider the flock’s center of mass relative to the path as well, steering the group toward the path collectively.

On the server/simulation side, we will likely update the agent update loop to include something like steer_toward(path_target) in each bird’s behavior, combined with their existing velocity and neighbor avoidance. We also need to consider path termination: once the birds reach the final destination point, they should stop or land (end of level logic), which likely already exists when birds enter the destination zone.

Step 6: Account for Bird Traits and New Obstacles

With the new path-following mechanic in place, we must consider how different bird characteristics affect their ability to follow the path and survive the journey. The game already simulates various traits; we’ll ensure they have meaningful influence in the path-drawing context:

Flock Cohesion Trait: Birds with high cohesion tendency will stick closer together when following the path, whereas low-cohesion birds may stray further from the group. This means if the flock gets spread out along a long curve or after avoiding an obstacle, high-cohesion birds will regroup more quickly. In gameplay terms, a tight cohesive flock is easier to keep on the drawn route (they behave like a single unit), while a low cohesion flock might see some individuals cutting corners or wandering off, possibly into danger. We should continue to use the cohesion behavior weights to maintain grouping around the path line.

Stress and Fatigue: We will introduce a link between stress levels and fatigue (energy burn). If birds become highly stressed (e.g. due to nearby predators or turbulence), they will tire faster – essentially increasing their energy consumption rate when stress is high. For example, a panicked bird might flap harder or waste energy, causing its endurance to drop quicker than a calm bird. We can implement this by scaling the energy drain: when a bird’s stress is above a threshold, apply a multiplier to its fatigue rate (so high stress =, say, +20% energy drain). This makes stressful situations (tight evasive maneuvers, predator chases) more costly in terms of stamina, aligning with the user’s note that stress increases fatigue speed. Birds with the stress_resilience trait will be less affected by this – their stress level rises more slowly or has less impact on fatigue. In effect, a resilient bird can keep a cooler head and not exhaust itself as quickly under pressure.

Endurance (Energy Efficiency): This trait determines how far a bird can travel on a full tank of energy. In the context of drawn paths, endurance is crucial for long or roundabout trajectories. A bird with higher energy efficiency will lose energy more slowly per distance traveled
GitHub
, allowing it to survive a longer path or a headwind section that others might not. When the player draws a path that pushes the limits of distance (say, going out-of-the-way to avoid all hazards), birds with low endurance may start dropping out (dying of exhaustion) before reaching the goal. This encourages players to consider path length carefully and perhaps include stops at food sources if available. We will use the existing energy mechanics (distance-based energy depletion) which already ensure longer paths consume more energy, and we’ll double-check it’s tuned so that most birds can make it if the player chooses an optimal route. We might also visualize the expected energy usage of the route in the planning phase (maybe a bar showing “this path will use ~80% of average energy” based on distance).

Speed Variation: Not all birds fly at exactly the same speed – there is a speed_factor trait that gives some variation. In path following, faster birds might move ahead along the path while slower ones lag. This can stretch out the flock, potentially reducing cohesion. If a few speedy leaders get too far ahead, they might even veer off path if they overshoot a turn before the slower birds catch up. To address this, we might cap the leading birds’ speed a bit when the flock is strung out (encourage them to slow down if far from the flock centroid). Conversely, slower birds with low speed_factor might struggle to keep up, especially if the path involves fighting wind or requires bursts of speed to escape hazards. The player can’t directly manage speeds, but they should be aware (via bird stats) that some birds simply might not keep up on a very aggressive route. This trait will create scenarios where, for instance, your fastest bird might always be at the front (and possibly first to encounter danger), whereas the slowest might be at risk of falling behind during long path segments.

Leadership Trait: If the simulation includes a leadership or flock influence trait, this becomes interesting in path following. A bird with high leadership tendency could inadvertently become a path guide or misguide. For example, if a leader deviates from the path (perhaps to skirt a hazard it personally wants to avoid), others might follow that bird instead of the drawn line. On the positive side, a leader that sticks to the path will help pull the flock along it, acting almost like an anchor to the planned route. We might simulate this by giving high-leadership birds a stronger pull toward the path target (so they effectively go first and others follow), or by weighting the cohesion/alignment so that neighbors follow leaders
GitHub
. This way, a strong leader can keep the flock on course, whereas in a flock with no clear leaders, you might get more diffusion around the path. Tuning this will be important so that the player’s path is still the primary guidance – leadership should modulate how tightly they adhere, not completely override the plan.

Hazard Awareness: Some birds are inherently better at detecting and avoiding hazards (predators, storms) courtesy of the hazard_awareness trait
GitHub
. These differences will play out when the path intersects or comes near a danger. A high-awareness bird might start to veer away from a storm even if the drawn path goes through it, because it “sees” the threat sooner. This could cause a temporary split – the wiser birds break formation to avoid the hazard, while lower-awareness birds blunder onward along the line and possibly into trouble. In design, this means even a well-drawn path through a hazard zone might not be followed perfectly by all: some will intelligently deviate (which could save their lives), but it might reduce cohesion. We should allow birds to deviate from the path for self-preservation if a hazard is immediately threatening. The path-following force would momentarily yield to hazard avoidance behavior. Once clear of the hazard, those birds could navigate back to the drawn route (perhaps rejoin at a later waypoint). From the player’s perspective, a bird with high awareness might survive a poor route choice (it flies around the storm the player drew through), whereas a low-awareness bird would trust the path too much and perish. This adds depth: the flock’s genetic makeup can forgive or punish the player’s route decisions.

Environmental Winds (Headwind/Tailwind): We will introduce wind as a significant environmental factor that the player must account for in their path. The game already has a wind field in the environment
GitHub
, but now we will emphasize persistent wind directions as “invisible obstacles.” A headwind (wind blowing against the flock’s direction of travel) will slow the birds’ ground speed and make them expend more energy to make progress. If the player draws a path straight into a strong headwind, the flock might crawl forward and many could run out of energy before the next rest, or be unable to outrun predators. Conversely, a tailwind (wind from behind) gives the birds a boost – they travel faster with less effort. We can simulate this by projecting the wind vector onto the birds’ velocity: when wind is aligned opposite to movement, add an effective drag or increase energy drain; with a tailwind, grant a speed increase or reduce energy cost. This was conceptually present in the original design via the Wind Lure beacon that boosted tailwinds
GitHub
, but now it will be part of the static environment rather than a player tool. We might display a wind indicator on the UI (like an arrow on the map or in a mini-map) so the player knows the prevailing wind direction and can draw the route accordingly (for example, maybe zig-zag to avoid long stretches of headwind, or go a bit out of the way to catch a tailwind corridor). Wind can also be spatially varied: perhaps certain map areas have stronger winds (like mountain passes or open ocean segments). These become natural obstacles — e.g., a corridor of headwind that the player might decide to circumvent by drawing a curved path around it, at the cost of distance.

Other Obstacles and Effects: Apart from wind, other hazards like storms and predators remain in play. As noted, flying through a storm could drastically increase fatigue (in current code, storms already cause rapid energy loss and can even kill birds with lightning
GitHub
). Our path system will likely encourage players to avoid storms entirely by drawing around them. If they don’t, expect heavy casualties or energy drain while inside the storm. We should make sure storm effects (increased stress, random course deviation, energy drain) are still functioning and perhaps amplify them to strongly discourage straight-lining through a storm. Predators (like a hawk that might attack the flock) will cause stress spikes and flock dispersion if encountered. Under the new system, players can’t divert on the fly, so if a predator is known to appear from a certain area, the drawn path should avoid that area or pass it when the predator isn’t around. It might be worth introducing some predictability or clues (e.g., “falcon nests here”) so players can plan paths that minimize exposure. If a predator does attack, birds will scatter or dodge on their own (which could pull them off the path briefly). Once safe, they should regroup and return toward the path on their own.

Finally, with all these factors considered, we will need to playtest and balance the new system. The lack of mid-flight control means if many birds are dying consistently, we may need to adjust parameters (e.g. make wind a bit less brutal or reduce hazard frequency) to give the player a fair chance through planning alone. We’ll also update tutorials and tooltips: instead of teaching beacon placement, the game should teach drawing effective paths (perhaps a training level where the optimal path is shown). The result of this overhaul is a more planning-centric, strategic experience: the player sketches a path, and the simulation of the flock’s behavior, influenced by their traits and the environment, determines the outcome
GitHub
GitHub
. It’s a significant shift, but if executed well, it will make Murmuration a unique strategy game where the challenge is to draw the perfect migration route and then trust your birds to follow it as nature and fate take their course.