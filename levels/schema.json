{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Murmuration Level Contract Schema",
  "type": "object",
  "required": [
    "id", "name", "distance_km", "time_limit_days", 
    "targets", "seasons_allowed", "hazards"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^W[1-5]-[1-4]$",
      "description": "Level identifier (World-Level)"
    },
    "name": {
      "type": "string",
      "description": "Human-readable level name"
    },
    "distance_km": {
      "type": "number",
      "minimum": 0,
      "description": "Migration distance in kilometers"
    },
    "time_limit_days": {
      "type": "integer",
      "minimum": 1,
      "maximum": 20,
      "description": "Time limit in days"
    },
    "targets": {
      "type": "object",
      "required": ["arrivals_min", "cohesion_avg_min", "losses_max", "beacon_budget_max"],
      "properties": {
        "arrivals_min": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum birds that must arrive"
        },
        "cohesion_avg_min": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum average cohesion"
        },
        "losses_max": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum allowed losses"
        },
        "diversity_min": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum genetic diversity (optional)"
        },
        "beacon_budget_max": {
          "type": "integer",
          "minimum": 3,
          "maximum": 8,
          "description": "Maximum beacon budget"
        }
      }
    },
    "seasons_allowed": {
      "type": "integer",
      "minimum": 2,
      "maximum": 3,
      "description": "Number of seasons allowed"
    },
    "hazards": {
      "type": "object",
      "properties": {
        "predator_hotspots": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of predator hotspot zones"
        },
        "storms": {
          "type": "object",
          "properties": {
            "planned_days": {
              "type": "array",
              "items": {"type": "integer"},
              "description": "Days when storms are guaranteed"
            },
            "random_daily_prob": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Daily probability of random storm"
            }
          }
        },
        "protected_zones": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["polygon", "death_cap"],
            "properties": {
              "polygon": {
                "type": "string",
                "description": "Polygon identifier for protected zone"
              },
              "death_cap": {
                "type": "integer",
                "minimum": 0,
                "description": "Maximum deaths allowed in zone"
              }
            }
          }
        },
        "light_pollution": {
          "type": "boolean",
          "description": "Whether light pollution hazards are active"
        }
      }
    },
    "notes": {
      "type": "string",
      "description": "Strategy hints or level description"
    }
  }
}